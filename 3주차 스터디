[Week 03] Chatbot with Deep Learning, Sequence to Sequence

일정: 2026.02.12 10:00~12:00

1. 챗봇(Chatbot)의 분류 및 구현 방식
챗봇은 크게 서비스 범위에 따라 두 가지로 나뉩니다.
- Closed-Domain Chatbot: 특정 업무(삼성생명 따봇, 연말정산 Q&A 등) 수행을 위해 키워드와 인텐트(의도) 기반으로 동작합니다.
- Open-Domain Chatbot: 주제 제한 없이 일상적인 대화를 나누는 챗봇(이루다, 심심이 등)입니다.

챗봇 구현 프로세스 
- 의도 분류(Intent Classification): 사용자의 질문이 어떤 카테고리(예: 예약, 날씨 문의)에 속하는지 파악합니다.
- 개체명 인식(Named Entity Recognition, NER): 질문 내 핵심 키워드(예: 지역, 날짜, 호텔명)를 추출합니다.
- 답변 생성: 파악된 의도와 추출된 엔티티를 미리 구현된 답변 함수나 API(날씨 API 등)에 입력하여 최종 답변을 생성합니다.

2. Sequence-to-Sequence (seq2seq)
입력 시퀀스로부터 다른 도메인의 시퀀스를 출력하는 모델로, 기계 번역과 텍스트 요약 등에 사용됩니다.
- 인코더(Encoder): 입력 문장의 정보를 압축하여 하나의 고정된 크기의 벡터인 컨텍스트 벡터(Context Vector)를 생성합니다.
- 디코더(Decoder): 컨텍스트 벡터를 초기 상태로 받아 번역된 단어를 순차적으로 생성합니다. 이때 문장의 시작을 알리는 <sos> 토큰과 끝을 알리는 <eos> 토큰을 사용합니다.
- 교사 강요(Teacher Forcing): 훈련 시 예측값 대신 실제 정답을 다음 시점의 입력으로 사용하여 학습 속도를 높이는 기법입니다.

3. 디코딩 알고리즘 및 토큰화
단순히 가장 확률이 높은 단어만 선택하는 방식의 한계를 극복하기 위한 방법들입니다.
- Beam Search: 매 시점마다 확률이 높은 K개의 후보(Beam size)를 유지하며 최적의 문장을 찾는 알고리즘입니다.
- 서브워드 토크나이저(Subword Tokenization):
    - BPE(Byte Pair Encoding): 빈도수가 높은 글자 쌍을 병합하여 단어 집합을 구축합니다. 이는 신조어나 희귀 단어 처리에 강점이 있어 OOV(Out-Of-Vocabulary) 문제를 해결합니다.
    - SentencePiece: 구글에서 공개한 오픈소스 토크나이저로, BPE 등의 알고리즘을 내장하며 언어에 상관없이 적용 가능합니다.

4. 성능 평가 지표: BLEU Score
기계가 번역한 문장(Candidate)과 사람이 번역한 정답 문장(Reference)을 비교하여 품질을 측정합니다.
- N-gram Precision: 단어(Unigram)뿐만 아니라 연이은 단어 묶음(Bigram, Trigram 등)이 얼마나 일치하는지 계산합니다.
- Modified Unigram Precision: 특정 단어가 과하게 반복되는 경우를 방지하기 위해 중복 일치 횟수를 보정합니다.
- Brevity Penalty: 기계 번역 결과가 너무 짧을 때 점수가 과하게 높아지는 것을 방지하기 위해 가하는 패널티입니다.

5. 기계 번역 서비스 구축 과정 
실제 서비스를 위해서는 다음과 같은 파이프라인이 필요합니다.
1) 데이터 수집 및 정제: 병렬 코퍼스 확보 및 노이즈 제거.
2) 토크나이저 선정: Mecab(한국어 특화) 또는 SentencePiece 사용.
3) 모델 학습 및 추론: 하이퍼파라미터 선정 및 Beam Search 적용.
4) 역토큰화(Detokenization): 분리된 토큰들을 다시 자연스러운 문장으로 복원.
5) 성능 평가: BLEU 등을 통한 모델 검증 및 배포.

- 느낀점
입력 문장을 하나의 고정된 컨텍스트 벡터로 압축하는 인코더-디코더 구조를 통해 기계 번역이 어떤 원리로 작동하는지 알게 됨.
정보가 손실되지 않도록 압축하고 이를 다시 다른 언어로 풀어내는 과정이 현대 자연어 처리의 근간이 된다는 점을 실감함.
단순한 Greedy 방식보다 Beam Search나, BPE기법을 배우며 데이터 전처리와 추론 알고리즘의 정교함이 서비스 품질을 결정한다는 것을 배움.
